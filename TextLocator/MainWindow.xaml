<Window x:Class="TextLocator.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:TextLocator"
        xmlns:rubyer="clr-namespace:Rubyer;assembly=Rubyer"
        mc:Ignorable="d"
        Title="搜索文本定位" Width="1366" Height="768" WindowStartupLocation="CenterScreen" Icon="Resource/App.ico" Loaded="Window_Loaded">
    <!-- DockPanel停靠容器 && Viewbox显示盒子 && Canvas画布 -->
    <DockPanel LastChildFill="True">
        <Viewbox Stretch="Fill">
            <Canvas Width="1366" Height="768">
                <!-- Grid布局 -->
                <StackPanel Width="1366" Height="768">
                    <!-- 头部 -->
                    <StackPanel Orientation="Horizontal" Height="140" VerticalAlignment="Top">
                        <!-- 搜索条件区 -->
                        <StackPanel Width="1000">
                            <!-- 搜索 -->
                            <StackPanel Margin="20,15,0,0" Orientation="Horizontal" >
                                <!-- 搜索框 -->
                                <TextBox x:Name="SearchText" Width="500" Height="36" FontSize="20" HorizontalAlignment="Left" VerticalContentAlignment="Center" BorderThickness="1" BorderBrush="Green">
                                    <TextBox.Resources>
                                        <VisualBrush x:Key="HintText" TileMode="None" Opacity="0.5" Stretch="None" AlignmentX="Left">
                                            <VisualBrush.Visual>
                                                <TextBlock Text="请输入搜索关键词" FontSize="20"/>
                                            </VisualBrush.Visual>
                                        </VisualBrush>
                                        <Style TargetType="{x:Type Border}">
                                            <Setter Property="CornerRadius" Value="4"/>
                                            <Setter Property="BorderBrush" Value="#c1d0dc"/>
                                        </Style>
                                    </TextBox.Resources>
                                    <TextBox.Style>
                                        <Style TargetType="TextBox">
                                            <Style.Triggers>
                                                <Trigger Property="Text" Value="{x:Null}">
                                                    <Setter Property="Background" Value="{StaticResource HintText}"/>
                                                </Trigger>
                                                <Trigger Property="Text" Value="">
                                                    <Setter Property="Background" Value="{StaticResource HintText}"/>
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBox.Style>
                                </TextBox>
                                <!-- 搜索按钮 -->
                                <Button x:Name="SearchButton" Content="搜索" Margin="10,0,0,0" Width="150" Height="35" Click="SearchButton_Click"/>
                                <!-- 清空按钮 -->
                                <Button x:Name="CleanButton" Content="清空" Margin="10,0,0,0" Width="150" Height="35" Background="Red" Click="CleanButton_Click"/>
                            </StackPanel>
                            <!-- 其他条件 -->
                            <StackPanel Margin="20,10,0,0" Orientation="Horizontal" >
                                <!-- 复选框 -->
                                <StackPanel>
                                    <Grid Margin="0,6,0,0">
                                        <!-- 匹配大小写 -->
                                        <CheckBox Content="匹配大小写" FontSize="16" HorizontalAlignment="Left" VerticalContentAlignment="Center"/>
                                        <!-- 匹配全词 -->
                                    </Grid>
                                    <Grid Margin="0,14,0,0">
                                        <!-- 匹配原始值 -->
                                        <!-- 仅文件名 -->
                                        <CheckBox Content="仅文件名" FontSize="16" HorizontalAlignment="Left" VerticalContentAlignment="Center"/>
                                    </Grid>
                                </StackPanel>
                                <!-- 分割线 -->
                                <GridSplitter Margin="30,0,30,0" Grid.Column="1" Width="1" HorizontalAlignment="Stretch" Background="Gray" />
                                <!-- 扩展信息 -->
                                <StackPanel>
                                    <!-- 扩展名 -->
                                    <Grid>
                                        <TextBlock Text="文件类型：" HorizontalAlignment="Left"/>
                                        <TextBox x:Name="FileExtensions" Text="doc,docm,docx,ppt,pptm,xls,xlsm,xlsx,htm,html,pdf,txt,java,css,cs" IsReadOnly="true" Width="700" Height="20" Margin="65,0,0,0" HorizontalAlignment="Left"/>
                                    </Grid>
                                    <!-- 文件夹 -->
                                    <Grid Margin="0,10,0,0" >
                                        <TextBlock Text="文件夹：" HorizontalAlignment="Left" Margin="12,0,0,0"/>
                                        <TextBox x:Name="Regions" Text="D:\UserData\" IsReadOnly="true" Width="700" Height="20" Margin="65,0,0,0" HorizontalAlignment="Left" MouseDoubleClick="Regions_MouseDoubleClick"/>
                                    </Grid>
                                </StackPanel>
                            </StackPanel>
                        </StackPanel>
                        <!-- 扩展区 -->
                        <StackPanel Width="365">
                            <!-- 搜索按钮 -->
                            <Button x:Name="OptimizeButton" Content="优化" ToolTip="增量更新索引，并删除不存在的文件索引" Margin="0,20,0,0" Width="150" Height="35" Background="DarkOrange" Click="OptimizeButton_Click"/>
                            <!-- 清空按钮 -->
                            <Button x:Name="RebuildButton" Content="重建" ToolTip="索引删除重建"  Margin="0,20,0,0" Width="150" Height="35" Background="DarkRed" Click="RebuildButton_Click"/>
                        </StackPanel>
                    </StackPanel>
                    <!-- 分割线 -->
                    <GridSplitter Grid.Column="1" Height="1" HorizontalAlignment="Stretch" Background="Gray" />
                    <!-- 中间 -->
                    <StackPanel Orientation="Horizontal" Height="601">
                        <!-- 左边 -->
                        <Grid Width="900" HorizontalAlignment="Left">
                            <!-- 条件和排序 -->
                            <Grid Height="40" VerticalAlignment="Top" Background="#F3F3F3">
                                <TextBlock Text="文件类型：" Margin="20,0,0,0"/>
                                <ComboBox x:Name="FileTypeFilter" Margin="80,0,0,0" Width="130" HorizontalAlignment="Left" Height="25">
                                    <ComboBoxItem Content="全部" IsSelected="True"/>
                                    <ComboBoxItem Content="Word类型"/>
                                    <ComboBoxItem Content="Excel类型"/>
                                    <ComboBoxItem Content="PowerPoint类型"/>
                                    <ComboBoxItem Content="PDF"/>
                                    <ComboBoxItem Content="XML/HTML"/>
                                    <ComboBoxItem Content="纯文本"/>
                                </ComboBox>

                                <!-- 排序 -->
                                <TextBlock Text="排序：" Margin="0,0,280,0" HorizontalAlignment="Right"/>
                                <Button Content="默认" Margin="0,0,220,0"  Width="60" Height="20" HorizontalAlignment="Right"/>
                                <Button Content="匹配度" Margin="0,0,150,0"  Width="60" Height="20" HorizontalAlignment="Right" Background="Gray"/>

                                <Button Content="时间" Margin="0,0,80,0" Width="60" Height="20" HorizontalAlignment="Right" Background="Gray"/>
                                <Button Content="大小" Margin="0,0,10,0" Width="60" Height="20" HorizontalAlignment="Right" Background="Gray"/>

                                <!-- 分割线 -->
                                <GridSplitter Grid.Column="1" Height="1" VerticalAlignment="Bottom" HorizontalAlignment="Stretch" Background="Gray" />
                            </Grid>
                            
                            <!-- 搜索结果列表 -->
                            <ListBox x:Name="SearchResultList" Margin="0,40,0,0" Height="560" VerticalAlignment="Top" BorderThickness="1" BorderBrush="#EAEAEB" Background="Transparent">
                                <ListBoxItem>
                                    <Grid Width="870" Height="110" HorizontalAlignment="Left" VerticalAlignment="Top">
                                        <!-- 图标 -->
                                        <Image Source="/Resource/ext/ext_word.png" Width="60" HorizontalAlignment="Left"/>
                                        <!-- 文件信息 -->
                                        <Grid Margin="80,0,0,0">
                                            <!-- 文件标题、大小、时间 -->
                                            <Grid VerticalAlignment="Top" Margin="0,10,0,0">
                                                <!-- 文件名 Click="Hyperlink_Click" -->
                                                <TextBlock HorizontalAlignment="Left">
                                                        <Hyperlink NavigateUri="http://www.qq.com">教 师 护 导 要 求（20210219）.doc</Hyperlink>
                                                </TextBlock>
                                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                                    <!-- 文件大小 -->
                                                    <TextBlock Text="1MB" Foreground="#545454" HorizontalAlignment="Right"/>
                                                    <TextBlock Text="•" Foreground="#545454" HorizontalAlignment="Right" Margin="20,0,20,0"/>
                                                    <!-- 文件大小 -->
                                                    <TextBlock Text="2021-08-31" Foreground="#545454" HorizontalAlignment="Right"/>
                                                </StackPanel>
                                            </Grid>

                                            <!-- 文件夹 -->
                                            <TextBlock Text="D:\桌面文档\金壕软件科技\教 师 护 导 要 求（20210219）.doc" Margin="0,30,0,0" Foreground="#006621" HorizontalAlignment="Left" VerticalAlignment="Top"/>

                                            <!-- 预览 -->
                                            <RichTextBox Margin="-5,50,0,0" Background="Transparent" HorizontalAlignment="Left" BorderThickness="0" VerticalAlignment="Top" IsDocumentEnabled="True">
                                                <FlowDocument>
                                                    <Paragraph>
                                                        <Run Foreground="#545454">项目1、乙方为甲方网站的服务器进行维护和管理，包括：病毒排查和清除、网站数据的备份，网站空间的定期清理和维护，服务器帐号的管理等服务，保证网站的正常运行和网站数据的完整性以及网站服务器帐号的安全。 项目2、乙方为甲方网站的系统程序进行维护和管理，包括：程序代码的整理和优化、排除程序代码的漏洞、排除因系统错误导致的故障、保证网站系统的正常运行。...</Run>
                                                    </Paragraph>
                                                </FlowDocument>
                                            </RichTextBox>
                                        </Grid>

                                        <!-- 分割线 -->
                                        <GridSplitter Grid.Column="1" Height="1" VerticalAlignment="Bottom" HorizontalAlignment="Stretch" Background="Gray" />
                                    </Grid>
                                </ListBoxItem>
                            </ListBox>
                        </Grid>
                        <!-- 分割线 -->
                        <GridSplitter Grid.Column="1" Width="1" HorizontalAlignment="Stretch" Background="Gray" />
                        <!-- 右边 -->
                        <Grid Width="464" HorizontalAlignment="Right">
                            <!-- 条件和排序 -->
                            <Grid Height="40" VerticalAlignment="Top" Background="#F3F3F3">
                                <!-- 打开文件 -->
                                <Image Source="/Resource/btn_file.png" ToolTip="打开文件" HorizontalAlignment="Left" Margin="10,5,0,5"/>
                                <!-- 打开文件夹 -->
                                <Image Source="/Resource/btn_folder.png" ToolTip="打开文件夹" HorizontalAlignment="Left" Margin="50,5,0,5"/>
                                
                                <!-- 分割线 -->
                                <GridSplitter Grid.Column="1" Height="1" VerticalAlignment="Bottom" HorizontalAlignment="Stretch" Background="Gray" />
                            </Grid>
                            <!-- 文件信息 -->
                            <Grid Margin="0,40,0,0" Height="40" VerticalAlignment="Top" Background="#F3F3F3">
                                <!-- 图标 -->
                                <Image x:Name="PreviewFileTypeIcon"  Source="/Resource/ext/ext_word.png" Margin="10,0,0,0" Width="40" HorizontalAlignment="Left"/>
                                <!-- 文件名 -->
                                <TextBlock x:Name="PreviewFileName" Text="教 师 护 导 要 求（20210219）.doc" FontWeight="Bold" Margin="50,0,0,0" HorizontalAlignment="Left" VerticalAlignment="Center"/>
                                <!-- 分割线 -->
                                <GridSplitter Grid.Column="1" Height="1" VerticalAlignment="Bottom" HorizontalAlignment="Stretch" Background="Gray" />
                            </Grid>
                            <!-- 内容预览 -->
                            <ScrollViewer Margin="0,80,0,0">
                                <!-- 预览 -->
                                <RichTextBox x:Name="PreviewFileContent" Margin="0,0,0,0" Background="Transparent" HorizontalAlignment="Left" BorderThickness="0" VerticalAlignment="Top" IsDocumentEnabled="True">
                                    <FlowDocument>
                                        <Paragraph>
                                            <Run>网站维护合同书
甲方名称：尚迪（上海）铝业有限公司          乙方名称：                    
联系电话：021-37595166                      联系电话：                         

甲、乙双方在平等自愿的基础上，经友好协商，就甲方委托乙方进行网站运行护及网
站信息维护的有关事宜达成一致，签订本合同。合同主要服务内容如下：

第一条：双方的权利和义务
一、乙方的权利和义务
（1）乙方为甲方的网站https://www.sdfaal.com/ _提供如下网站维护的服务

项目1、乙方为甲方网站的服务器进行维护和管理，包括：病毒排查和清除、网站数据的备份，网站空间的定期清理和维护，服务器帐号的管理等服务，保证网站的正常运行和网站数据的完整性以及网站服务器帐号的安全。
项目2、乙方为甲方网站的系统程序进行维护和管理，包括：程序代码的整理和优化、排除程序代码的漏洞、排除因系统错误导致的故障、保证网站系统的正常运行。如甲方要求在当前网站系统的功能之上，重新增加新的网站系统或修改现有功能基础上之外的功能．需另外支付费用。
项目3、乙方为甲方网站的信息内容进行维护和管理，包括：网站文字内容信息的修改（不包括网站FLASHI、网站版式以及网站风格的修改）、公司产品信息的数据备份。如
甲方要求在当前网站风格、版式以及页面数的基础上，重新增加功能性新的页面或修
改网站风格和版式时，需另外支付费用。
顶目4、乙方为甲方网站的数据库进行维护和管理，包括：对网站数据库进行整理和优化、定期检测数据库的信息的准确性、清除多余数据、定期备份数据库等服务。保证网站数据库数据的合法、完整以及难确。

（2）甲方提供网站信息维护所需的文字、图片及所有资料乙方按照双方商定的维护方案
根据修改内容的工作量大小，在24小时到48小时内完成网站信息维护工作（如遇自然灾害
或特殊情况造成停电、网络设备故障、电脑设备故障等乙方有权要求延期完成）；乙方在完
成后应及时告知甲方，同时；甲方在确认网站信息维护工作完成后，应及时告知乙方，甲
方不得随意修改。如确需修改，乙方可配合，并在24小时内完成修改。（不包括资料上传）

（3）乙方保证对甲方提供的资料保密，并于甲方结束代管后将甲方历次提供的资料归还
于甲方并不得再使用甲方的网站料或将甲方的资料转移给第三方。合同任何一方在合同履
行中所获悉另一方的商业秘密，均负有保密义务。

二、甲方的权利和义务
（1）甲方自正式签订协议之日起需提供网站详细资料予乙方（如网站FTP信息等）
（2）甲方需按时将网站费用交予乙方，甲方不得拖延交费；
（3）甲方提供给乙方的所有更新、维护信息资料、方案需详细完整并且符合法律规定，乙
方不对甲方提供的信息真实性负任何责任，乙方有义务对甲方提供的信息保密；
（4）甲方应及时提供给乙方需要的资料信息，由于甲方提供的资料不及时、不完整、错误
导致乙方不能按时、正确的更新和维护，所造成的损失由甲方自行负责；
（5）甲方保证其提供的文字及图片资料具有合法的来源和使用权，甲方对提供给乙方的所
有内容的真实性和合法性负完全责任，一切由其内容所引起的纠纷、争议及所涉及的法律责
任均由甲方承担；
（6）乙方保证对甲方提供的资料保密，并于结束本合同后，将甲方历次提供的资料归还于
甲方并不得再使用甲方的资料或将甲方的资料转移给第三方。合同任何一方在合同履行中所
获悉另一方的商业秘密，均负有保密义务。

第二条：网站维护情况
1、乙方为甲方提供网站维护  1   年：2021 年 7月 1 日 至  2022 年 7 月 1 日；
2、乙方为甲方维护期间，如甲方使用了乙方提供的产品（如：域名、云服务器、企业邮箱
等）应支付给乙方相应的费用。
3、如甲方要求乙方更新、维护、处理其网站上的图片或 FLASHI动画，工作量特别大（超
过两个工作日）时应支付乙方相应费用。
第三条：费用和支付
一、支付协议
（1）甲方签定本合同时支付乙方维护费用7000元。 
二、付款方式：（请在相应的¨中划√） 
1）  ¨现金；
2）  ¨企业支付宝；
3）  ¨转账、汇款；
       
第四条：违约责任

1、	甲方没有按时履行支付义务，乙方有权停止对甲方服务。
2、	乙方没有按时履行维护义务，甲方有权停止维护，并要求乙方退回部分维护费。
3、若甲方要提前终止本合同，必须提前15日通知乙方，乙方退回部分维护费，本合同终止。

第五条：其他条约
一、本合同书一式两份双方各持一份，且具有同等法律效力。合同经双方授权代表签字，自
签订日起生效。本合同有效期为 1  年，自2021 年 7月 1 日 至  2022 年 7 月 1 日，期满本合同自动终止。
二、本合同未尽事宜：双方应在本合同达成的原则基础上以补充条款的方式明确，补充条款
与本合同具有同等的法律效力。
三、本合同附件、备注说明，为本合同不可分割的一部分・与合同正文具有同等法律效力。



甲方：                                          乙方：

代表人：                                        代表人：

日期：                                          日期：</Run>
                                        </Paragraph>
                                    </FlowDocument>
                                </RichTextBox>
                            </ScrollViewer>
                        </Grid>
                    </StackPanel>
                    <!-- 分割线 -->
                    <GridSplitter Grid.Column="1" Height="1" HorizontalAlignment="Stretch" Background="Gray" />
                    <!-- 底部 -->
                    <Grid Height="25" Background="#C8C8C8">
                        <!-- <ProgressBar Width="150" Margin="10,0,0,0" HorizontalAlignment="Left"
                                     IsIndeterminate="True"
                                                rubyer:ProgressBarHelper.Thickness="20"/> -->
                        <TextBlock x:Name="WorkStatus" Text="就绪" Margin="10,0,0,0" HorizontalAlignment="Left"/>
                    </Grid>
                </StackPanel>
            </Canvas>
        </Viewbox>
    </DockPanel>
</Window>
